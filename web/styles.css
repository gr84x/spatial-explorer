/* Spatial Explorer UI â€” design-token driven, mobile-first */

:root{
  /* Typography */
  --font-sans: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";

  /* Spacing scale (8px base) */
  --space-0: 0px;
  --space-1: 8px;
  --space-2: 16px;
  --space-3: 24px;
  --space-4: 32px;
  --space-5: 40px;
  --space-6: 48px;

  /* Radii */
  --radius-sm: 10px;
  --radius-md: 14px;
  --radius-lg: 18px;
  --radius-pill: 999px;

  /* Colors (dark theme default) */
  --color-bg: #07090b;
  --color-surface: rgba(16,18,20,.74);
  --color-surface-2: rgba(10,10,10,.50);
  --color-border: rgba(255,255,255,.10);
  --color-border-2: rgba(255,255,255,.16);
  --color-text: rgba(255,255,255,.90);
  --color-muted: rgba(255,255,255,.66);
  --color-accent: #60a5fa;
  --color-success: #22c55e;
  --color-danger: #ef4444;

  /* Component surfaces */
  --color-control-bg: rgba(10,10,10,.48);
  --color-control-bg-hover: rgba(10,10,10,.56);
  --color-card-bg: rgba(10,10,10,.36);
  --color-row-bg: rgba(10,10,10,.40);
  --color-tooltip-bg: rgba(16,18,20,.92);
  --color-drop-bg: rgba(16,18,20,.65);

  /* Canvas / export background */
  --canvas-base: #0a0a0a;
  --canvas-glow-0: rgba(255,255,255,.04);
  --canvas-glow-1: rgba(0,0,0,0);

  /* Render token aliases (used from JS) */
  --text: var(--color-text);
  --muted: var(--color-muted);
  --border: var(--color-border);
  --accent: var(--color-accent);
  --green: var(--color-success);

  --tissue-fill: rgba(255,255,255,.015);
  --tissue-stroke: rgba(255,255,255,.07);
  --annotation: rgba(255,255,255,.66);

  --scalebox-bg: rgba(16,18,20,.72);
  --scalebox-stroke: rgba(255,255,255,.12);
  --scalebar: rgba(255,255,255,.85);
  --scalebar-top: rgba(0,0,0,.35);
  --scale-text: rgba(255,255,255,.82);

  --hover-ring: rgba(255,255,255,.85);

  /* Shadows */
  --shadow-sm: 0 8px 18px rgba(0,0,0,.28);
  --shadow-md: 0 12px 34px rgba(0,0,0,.36);

  /* Motion */
  --ease-standard: cubic-bezier(.2,.8,.2,1);
  --dur-fast: 120ms;
  --dur-med: 180ms;

  color-scheme: dark;
}

/* Light theme (opt-in via <html data-theme="light">) */
html[data-theme="light"]{
  --color-bg: #f8fafc;
  --color-surface: rgba(255,255,255,.78);
  --color-surface-2: rgba(255,255,255,.60);
  --color-border: rgba(2,6,23,.10);
  --color-border-2: rgba(2,6,23,.16);
  --color-text: rgba(2,6,23,.88);
  --color-muted: rgba(2,6,23,.60);

  --color-control-bg: rgba(255,255,255,.72);
  --color-control-bg-hover: rgba(255,255,255,.88);
  --color-card-bg: rgba(255,255,255,.66);
  --color-row-bg: rgba(255,255,255,.74);
  --color-tooltip-bg: rgba(255,255,255,.94);
  --color-drop-bg: rgba(255,255,255,.72);

  --canvas-base: #ffffff;
  --canvas-glow-0: rgba(96,165,250,.16);
  --canvas-glow-1: rgba(255,255,255,0);

  --tissue-fill: rgba(2,6,23,.03);
  --tissue-stroke: rgba(2,6,23,.10);
  --annotation: rgba(2,6,23,.66);

  --scalebox-bg: rgba(255,255,255,.82);
  --scalebox-stroke: rgba(2,6,23,.14);
  --scalebar: rgba(2,6,23,.78);
  --scalebar-top: rgba(2,6,23,.10);
  --scale-text: rgba(2,6,23,.76);

  --hover-ring: rgba(2,6,23,.74);

  color-scheme: light;
}

/* If user has no explicit theme preference, respect system scheme */
@media (prefers-color-scheme: light){
  html:not([data-theme]){
    --color-bg: #f8fafc;
    --color-surface: rgba(255,255,255,.78);
    --color-surface-2: rgba(255,255,255,.60);
    --color-border: rgba(2,6,23,.10);
    --color-border-2: rgba(2,6,23,.16);
    --color-text: rgba(2,6,23,.88);
    --color-muted: rgba(2,6,23,.60);

    --color-control-bg: rgba(255,255,255,.72);
    --color-control-bg-hover: rgba(255,255,255,.88);
    --color-card-bg: rgba(255,255,255,.66);
    --color-row-bg: rgba(255,255,255,.74);
    --color-tooltip-bg: rgba(255,255,255,.94);
    --color-drop-bg: rgba(255,255,255,.72);

    --canvas-base: #ffffff;
    --canvas-glow-0: rgba(96,165,250,.16);
    --canvas-glow-1: rgba(255,255,255,0);

    --tissue-fill: rgba(2,6,23,.03);
    --tissue-stroke: rgba(2,6,23,.10);
    --annotation: rgba(2,6,23,.66);

    --scalebox-bg: rgba(255,255,255,.82);
    --scalebox-stroke: rgba(2,6,23,.14);
    --scalebar: rgba(2,6,23,.78);
    --scalebar-top: rgba(2,6,23,.10);
    --scale-text: rgba(2,6,23,.76);

    --hover-ring: rgba(2,6,23,.74);

    color-scheme: light;
  }
}

*{ box-sizing:border-box; }

html, body{ height:100%; }

body{
  margin:0;
  font-family: var(--font-sans);
  background:
    radial-gradient(1100px 660px at 22% -12%, rgba(96,165,250,.18), transparent 56%),
    radial-gradient(960px 580px at 92% 10%, rgba(34,197,94,.10), transparent 56%),
    var(--color-bg);
  color: var(--color-text);
}

html[data-theme="light"] body{
  background:
    radial-gradient(1100px 660px at 22% -12%, rgba(96,165,250,.12), transparent 56%),
    radial-gradient(960px 580px at 92% 10%, rgba(34,197,94,.08), transparent 56%),
    var(--color-bg);
}

@media (prefers-color-scheme: light){
  html:not([data-theme]) body{
    background:
      radial-gradient(1100px 660px at 22% -12%, rgba(96,165,250,.12), transparent 56%),
      radial-gradient(960px 580px at 92% 10%, rgba(34,197,94,.08), transparent 56%),
      var(--color-bg);
  }
}

a{ color: var(--color-accent); text-decoration:none; }
a:hover{ text-decoration:underline; }

:focus-visible{
  outline: 2px solid rgba(96,165,250,.75);
  outline-offset: 2px;
}

.wrap{ max-width: 1200px; margin: 0 auto; padding: var(--space-2); }

/* Header */
header{
  display:flex;
  flex-direction:column;
  gap: var(--space-2);
  align-items:flex-start;
  justify-content:space-between;
  margin-bottom: var(--space-2);
}

.titleblock h1{
  margin:0 0 var(--space-1) 0;
  font-size: 20px;
  letter-spacing: .2px;
  line-height:1.15;
}

.tagline{
  color: var(--color-muted);
  font-weight: 500;
  font-size: 12px;
  margin-left: 10px;
  vertical-align: middle;
}

.titleblock p{ margin:0; color: var(--color-muted); line-height: 1.45; max-width: 68ch; }

.badge{
  display:inline-flex;
  align-items:center;
  gap: var(--space-1);
  padding: 10px 12px;
  border: 1px solid var(--color-border);
  border-radius: var(--radius-pill);
  color: var(--color-muted);
  background: var(--color-surface);
  backdrop-filter: blur(10px);
  box-shadow: var(--shadow-sm);
  user-select:none;
  white-space:nowrap;
}

.dot{
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--color-success);
  box-shadow: 0 0 0 3px rgba(34,197,94,.15);
}

/* Layout */
.grid{
  display:grid;
  grid-template-columns: 1fr;
  gap: var(--space-2);
  align-items:stretch;
}

.panel{
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-md);
  backdrop-filter: blur(12px);
  overflow:hidden;
}

/* Viz */
.viz{ position:relative; min-height: 470px; display:flex; flex-direction:column; }

.vizbar{
  display:flex;
  flex-direction:column;
  gap: var(--space-1);
  padding: var(--space-2);
  border-bottom: 1px solid var(--color-border);
  align-items:stretch;
  justify-content:space-between;
}

.vizbar .left{ display:flex; gap: var(--space-1); align-items:flex-start; flex-wrap:wrap; }

.field{
  display:flex;
  align-items:center;
  gap: var(--space-1);
  padding: 10px 12px;
  background: var(--color-control-bg);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  color: var(--color-text);
  min-width: min(460px, 100%);
  flex:1;
}

.field label{ font-size: 12px; color: var(--color-muted); user-select:none; }

.field input{
  width: 100%;
  background: transparent;
  border: none;
  outline: none;
  color: var(--color-text);
  font-size: 13px;
}

.hint{ font-size: 12px; color: var(--color-muted); line-height: 1.35; }

.controls{ display:flex; gap: var(--space-1); align-items:center; flex-wrap:wrap; }

.uploadHelp{
  flex-basis: 100%;
  font-size: 12px;
  color: var(--color-muted);
  line-height: 1.35;
  margin-top: 2px;
}

.btn{
  appearance:none;
  border: 1px solid var(--color-border);
  background: var(--color-control-bg);
  color: var(--color-text);
  border-radius: var(--radius-md);
  padding: 9px 12px;
  font-size: 12px;
  cursor:pointer;
  user-select:none;
  transition: transform var(--dur-fast) var(--ease-standard), border-color var(--dur-med) var(--ease-standard), background var(--dur-med) var(--ease-standard);
}

.btn:hover{ border-color: var(--color-border-2); background: var(--color-control-bg-hover); }
.btn:active{ transform: translateY(1px); }

.btn--primary{
  border-color: rgba(96,165,250,.35);
  background: rgba(96,165,250,.14);
}
.btn--primary:hover{ border-color: rgba(96,165,250,.55); background: rgba(96,165,250,.18); }

.btn--cta{
  padding: 11px 14px;
  font-weight: 600;
  letter-spacing: .01em;
  box-shadow: 0 10px 26px rgba(0,0,0,.28);
}

.formRow{ display:flex; align-items:center; gap: 6px; font-size: 12px; color: var(--color-muted); }

.input-sm, .select-sm{
  background: var(--color-control-bg);
  color: var(--color-text);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-sm);
  padding: 8px 10px;
  font-size: 12px;
  outline:none;
}

.input-sm{ width: 92px; }

.input-pill{
  width: 100%;
  background: var(--color-control-bg);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  padding: 10px 10px;
  color: var(--color-text);
  font-size: 12px;
  outline: none;
}

.canvasWrap{ position:relative; flex:1; }
.canvasWrap canvas{ position:absolute; inset:0; width:100%; height:100%; display:block; }

.welcomeOverlay{
  position:absolute;
  inset: var(--space-2);
  display:none;
  place-items:center;
  z-index: 3;
  pointer-events:none;
}

.welcomeCard{
  pointer-events:auto;
  width: min(560px, 100%);
  padding: 18px 18px;
  border-radius: var(--radius-lg);
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(16,18,20,.82);
  backdrop-filter: blur(10px);
  box-shadow: var(--shadow-md);
}

.welcomeTitle{
  font-size: 14px;
  font-weight: 700;
  margin-bottom: 6px;
}

.welcomeText{
  font-size: 12px;
  color: var(--color-muted);
  line-height: 1.45;
}

.welcomeActions{
  display:flex;
  gap: var(--space-1);
  flex-wrap:wrap;
  margin-top: 12px;
}

.welcomeFootnote{
  margin-top: 12px;
  font-size: 12px;
  color: var(--color-muted);
  line-height: 1.4;
}
#gl{ pointer-events:none; background:transparent; }
#c{ background: radial-gradient(900px 600px at 50% 45%, var(--canvas-glow-0), var(--canvas-glow-1) 55%); }

.tooltip{
  position:absolute;
  pointer-events:none;
  transform: translate(10px, 10px);
  padding: 10px 12px;
  background: var(--color-tooltip-bg);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  font-size: 12px;
  color: var(--color-text);
  max-width: 280px;
  display:none;
  box-shadow: var(--shadow-md);
}

.tooltip .muted{ color: var(--color-muted); }

.dropOverlay{
  position:absolute;
  inset: var(--space-1);
  border: 1px dashed rgba(255,255,255,.25);
  border-radius: var(--radius-md);
  display:none;
  place-items:center;
  background: var(--color-drop-bg);
  backdrop-filter: blur(8px);
}

html[data-theme="light"] .dropOverlay{
  border-color: rgba(2,6,23,.18);
}

@media (prefers-color-scheme: light){
  html:not([data-theme]) .dropOverlay{
    border-color: rgba(2,6,23,.18);
  }
}

/* Sidebar */
.side{ display:flex; flex-direction:column; gap: var(--space-2); padding: var(--space-2); }

.sectionTitle{
  font-size: 12px;
  letter-spacing: .16em;
  text-transform: uppercase;
  color: var(--color-muted);
  margin: 0 0 var(--space-1) 0;
}

.card{
  border: 1px solid var(--color-border);
  background: var(--color-card-bg);
  border-radius: var(--radius-md);
  padding: var(--space-2);
  transition: border-color var(--dur-med) var(--ease-standard);
}

.card:hover{ border-color: rgba(255,255,255,.14); }

html[data-theme="light"] .card:hover{
  border-color: rgba(2,6,23,.14);
}
@media (prefers-color-scheme: light){
  html:not([data-theme]) .card:hover{ border-color: rgba(2,6,23,.14); }
}

.legend{ display:flex; flex-direction:column; gap: var(--space-1); }

.legendRow{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 10px;
  padding: 10px 12px;
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  background: var(--color-row-bg);
  transition: border-color var(--dur-med) var(--ease-standard), transform var(--dur-fast) var(--ease-standard);
}

.legendRow:hover{ border-color: var(--color-border-2); transform: translateY(-1px); }

.legendLeft{ display:flex; align-items:center; gap: 10px; min-width:0; }
.swatch{ width: 10px; height:10px; border-radius: 3px; box-shadow: 0 0 0 3px rgba(255,255,255,.06); }
html[data-theme="light"] .swatch{ box-shadow: 0 0 0 3px rgba(2,6,23,.06); }
@media (prefers-color-scheme: light){
  html:not([data-theme]) .swatch{ box-shadow: 0 0 0 3px rgba(2,6,23,.06); }
}

.legendName{ font-size: 13px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.legendMeta{ display:flex; align-items:center; gap: 10px; color: var(--color-muted); font-size: 12px; }

.check{ display:flex; align-items:center; gap: 10px; }
input[type="checkbox"]{ width: 16px; height: 16px; accent-color: var(--color-accent); }

.kv{ display:grid; grid-template-columns: 1fr auto; gap: 8px 10px; align-items:center; }
.k{ color: var(--color-muted); font-size: 12px; }
.v{ font-size: 12px; }

.bars{ display:flex; flex-direction:column; gap: var(--space-1); margin-top: var(--space-1); }
.barRow{ display:grid; grid-template-columns: 92px 1fr 44px; gap: 10px; align-items:center; }
.barLabel{ font-size: 12px; color: var(--color-muted); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.barTrack{ height: 10px; border-radius: var(--radius-pill); background: rgba(255,255,255,.06); overflow:hidden; border: 1px solid rgba(255,255,255,.06); }
html[data-theme="light"] .barTrack{ background: rgba(2,6,23,.06); border-color: rgba(2,6,23,.08); }
@media (prefers-color-scheme: light){
  html:not([data-theme]) .barTrack{ background: rgba(2,6,23,.06); border-color: rgba(2,6,23,.08); }
}

.barFill{ height:100%; border-radius: var(--radius-pill); background: linear-gradient(90deg, rgba(96,165,250,.95), rgba(34,197,94,.85)); }
.barVal{ font-variant-numeric: tabular-nums; font-size: 12px; color: var(--color-text); text-align:right; }

.note{ color: var(--color-muted); font-size: 12px; line-height: 1.4; }
.statusLine{ font-size: 12px; color: var(--color-muted); margin-top: var(--space-1); }
.statusLine strong{ color: var(--color-text); font-weight: 600; }

@media (min-width: 980px){
  header{ flex-direction:row; align-items:flex-start; }
  .grid{ grid-template-columns: 1.35fr .65fr; }
  .viz{ min-height: 520px; }
  .vizbar{ flex-direction:row; align-items:center; }
  .vizbar .left{ align-items:center; }
  .field{ min-width: 260px; max-width: 540px; flex: 0 1 520px; }
}

/* Footer */
.siteFooter{
  margin-top: var(--space-2);
  padding-top: var(--space-2);
  padding-bottom: var(--space-1);
  border-top: 1px solid var(--color-border);
  text-align:center;
  font-size: 0.75rem;
  color: var(--color-muted);
}

.siteFooter a{
  color: var(--color-muted);
  text-decoration: none;
}

.siteFooter a:hover{
  color: var(--color-text);
  text-decoration: underline;
}

@media (prefers-reduced-motion: reduce){
  *, *::before, *::after{ transition:none !important; animation:none !important; }
}
